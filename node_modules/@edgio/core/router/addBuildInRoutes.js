"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const environment_1 = require("../environment");
const constants_1 = require("../constants");
function addBuiltInRoutes(router) {
    try {
        // Add @edgio/devtools built-in routes if the module is installed
        require('@edgio/devtools/addBuiltInRoutes')({
            router,
            local: (0, environment_1.isLocal)(),
        });
    }
    catch (e) {
        // istanbul ignore if
        // @ts-ignore
        if (e.code !== 'MODULE_NOT_FOUND') {
            throw e;
        }
    }
    if (!router.routerOptions.indexPermalink) {
        /**
         * Disables crawling of permalinks by setting the `x-robots-tag: noindex` response header
         * for hosts matching edgio.link or edgio-perma.link.
         */
        router.match({
            headers: {
                host: constants_1.HOSTS_NOINDEX_PERMALINK_REGEX,
            },
        }, {
            headers: {
                add_response_headers: {
                    'x-robots-tag': 'nofollow, noindex',
                },
            },
        });
    }
}
exports.default = addBuiltInRoutes;
